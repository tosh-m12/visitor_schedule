<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 6px;
            border: 1px solid #999;
            text-align: center;
            font-size: 14px;
        }
        .cancelled-row td {
            color: red;
            text-decoration: line-through;
        }
    </style>
</head>
<body>
    <p>外ロジ各位<br>
    外通各位</p>

    <p>本日以降の来客予定を展開いたします。<br>
    今天之后将开展客户来访预定。</p>

    <p>※現場においては5S・挨拶・安全管理の徹底をお願いします。<br>
    ※请彻底在現場实施5S、打招呼及安全管理。</p>

    {% if visitors %}
    <table>
        <thead>
            <tr>
                <th>来訪日</th>
                <th>時間</th>
                <th>時間未定</th>
                <th>会社名</th>
                <th>姓</th>
                <th>名</th>
                <th>役職</th>
                <th>目的</th>
                <th>訪問場所</th>
                <th>入力者</th>
                <th>備考</th>
            </tr>
        </thead>
        <tbody>
            {% for v in visitors %}
            <tr class="{% if v.is_cancelled %}cancelled-row{% endif %}">
                <td>{{ v.visit_date }}</td>
                <td>{{ v.visit_time }}</td>
                <td>{% if v.time_undecided_flag %}✔{% endif %}</td>
                <td>{{ v.company_name }}</td>
                <td>{{ v.last_name }}</td>
                <td>{{ v.first_name }}</td>
                <td>{{ v.title }}</td>
                <td>{{ v.purpose }}</td>
                <td>{{ v.location }}</td>
                <td>{{ v.host_staff }}</td>
                <td>{{ v.notes }}</td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
    {% else %}
        <p>本日以降の来訪予定はありません。</p>
    {% endif %}
</body>
</html>
