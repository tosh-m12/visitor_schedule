{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>è¨­å®šç®¡ç†ç”»é¢</title>
    <link rel="stylesheet" href="{% static 'visitors/style.css' %}">
    <style>
        table { margin-bottom: 30px; width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        h2 { margin-top: 40px; }
        input[type="text"], input[type="time"] { width: 100%; }
        .delete-btn { color: red; cursor: pointer; }
    </style>
    <script>
        function addRow(sectionId, inputName) {
            const container = document.getElementById(sectionId);
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" name="${inputName}" /></td>
                <td><span class="delete-btn" onclick="this.parentElement.parentElement.remove()">å‰Šé™¤</span></td>
            `;
            container.appendChild(newRow);
        }
    </script>
</head>
<body>
    <h1>è¨­å®šç®¡ç†ç”»é¢</h1>
    <form method="post">
        {% csrf_token %}

        <h2>ğŸ“§ ãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆ</h2>
        <table>
            <thead>
                <tr><th>Email ã‚¢ãƒ‰ãƒ¬ã‚¹</th><th>æ“ä½œ</th></tr>
            </thead>
            <tbody id="mailing-list-section">
                {% for email in mailing_list %}
                <tr>
                    <td><input type="text" name="emails" value="{{ email }}"></td>
                    <td><span class="delete-btn" onclick="this.parentElement.parentElement.remove()">å‰Šé™¤</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="button" onclick="addRow('mailing-list-section', 'emails')">ï¼‹ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿½åŠ </button>

        <h2>ğŸ“… ä¼‘æ—¥è¨­å®šï¼ˆé€ä¿¡å¯¾è±¡å¤–æ—¥ï¼‰</h2>
        <table>
            <thead>
                <tr><th>æ—¥ä»˜ï¼ˆYYYY-MM-DDï¼‰</th><th>æ“ä½œ</th></tr>
            </thead>
            <tbody id="holiday-section">
                {% for date in holidays %}
                <tr>
                    <td><input type="text" name="holidays" value="{{ date }}"></td>
                    <td><span class="delete-btn" onclick="this.parentElement.parentElement.remove()">å‰Šé™¤</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="button" onclick="addRow('holiday-section', 'holidays')">ï¼‹ æ—¥ä»˜ã‚’è¿½åŠ </button>

        <h2>ğŸ“¨ ãƒ¡ãƒ¼ãƒ«é€ä¿¡æ™‚åˆ»ï¼ˆå…¨ç¤¾å‘ã‘é€šçŸ¥ï¼‰</h2>
        <table>
            <tr>
                <th>é€ä¿¡æ™‚åˆ»ï¼ˆä¾‹: 09:00ï¼‰</th>
                <td><input type="time" name="send_time" value="{{ send_time }}"></td>
            </tr>
        </table>

        <br><br>
        <button type="submit">ğŸ’¾ ä¿å­˜</button>
    </form>

    <form method="post" action="{% url 'run_email' %}" onsubmit="return confirmSend();">
        {% csrf_token %}
        <button type="submit">ğŸ“¨ ä»Šã™ãé€ä¿¡</button>
    </form>
    <script>
        function confirmSend() {
            return confirm("ãƒ¡ãƒ¼ãƒ«ã‚’ä»Šã™ãé€ä¿¡ã—ã¾ã™ã‹ï¼Ÿ");
        }
    </script>

    <p><a href="{% url 'index' %}">â† ä¸€è¦§ã«æˆ»ã‚‹</a></p>
</body>
</html>
